(function(){var e=angular.module("angularFileUpload",[]);e.service("$upload",["$http","$timeout",function(e,t){function n(n){n.method=n.method||"POST";n.headers=n.headers||{};n.transformRequest=n.transformRequest||function(t,n){if(window.ArrayBuffer&&t instanceof window.ArrayBuffer){return t}return e.defaults.transformRequest[0](t,n)};if(window.XMLHttpRequest.__isShim){n.headers["__setXHR_"]=function(){return function(e){if(!e)return;n.__XHR=e;n.xhrFn&&n.xhrFn(e);e.upload.addEventListener("progress",function(e){if(n.progress){t(function(){if(n.progress)n.progress(e)})}},false);e.upload.addEventListener("load",function(e){if(e.lengthComputable){if(n.progress)n.progress(e)}},false)}}}var r=e(n);r.progress=function(e){n.progress=e;return r};r.abort=function(){if(n.__XHR){t(function(){n.__XHR.abort()})}return r};r.xhr=function(e){n.xhrFn=e;return r};r.then=function(e,t){return function(r,i,s){n.progress=s||n.progress;var o=t.apply(e,[r,i,s]);o.abort=e.abort;o.progress=e.progress;o.xhr=e.xhr;o.then=e.then;return o}}(r,r.then);return r}this.upload=function(t){t.headers=t.headers||{};t.headers["Content-Type"]=undefined;t.transformRequest=t.transformRequest||e.defaults.transformRequest;var r=new FormData;var i=t.transformRequest;var s=t.data;t.transformRequest=function(e,n){if(s){if(t.formDataAppender){for(var r in s){var o=s[r];t.formDataAppender(e,r,o)}}else{for(var r in s){var o=s[r];if(typeof i=="function"){o=i(o,n)}else{for(var u=0;u<i.length;u++){var a=i[u];if(typeof a=="function"){o=a(o,n)}}}e.append(r,o)}}}if(t.file!=null){var f=t.fileFormDataName||"file";if(Object.prototype.toString.call(t.file)==="[object Array]"){var l=Object.prototype.toString.call(f)==="[object String]";for(var u=0;u<t.file.length;u++){e.append(l?f+u:f[u],t.file[u],t.file[u].name)}}else{e.append(f,t.file,t.file.name)}}return e};t.data=r;return n(t)};this.http=function(e){return n(e)}}]);e.directive("ngFileSelect",["$parse","$timeout",function(e,t){return function(n,r,i){var s=e(i["ngFileSelect"]);r.bind("change",function(e){var r=[],i,o;i=e.target.files;if(i!=null){for(o=0;o<i.length;o++){r.push(i.item(o))}}t(function(){s(n,{$files:r,$event:e})})});if("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){r.bind("touchend",function(e){e.preventDefault();e.target.click()})}}}]);e.directive("ngFileDropAvailable",["$parse","$timeout",function(e,t){return function(n,r,i){if("draggable"in document.createElement("span")){var s=e(i["ngFileDropAvailable"]);t(function(){s(n)})}}}]);e.directive("ngFileDrop",["$parse","$timeout",function(e,t){return function(n,r,i){if("draggable"in document.createElement("span")){var s=null;var o=e(i["ngFileDrop"]);r[0].addEventListener("dragover",function(e){t.cancel(s);e.stopPropagation();e.preventDefault();r.addClass(i["ngFileDragOverClass"]||"dragover")},false);r[0].addEventListener("dragleave",function(e){s=t(function(){r.removeClass(i["ngFileDragOverClass"]||"dragover")})},false);var u=0;function a(e,t){if(t.isDirectory){var n=t.createReader();u++;n.readEntries(function(t){for(var n=0;n<t.length;n++){a(e,t[n])}u--})}else{u++;t.file(function(t){u--;e.push(t)})}}r[0].addEventListener("drop",function(e){e.stopPropagation();e.preventDefault();r.removeClass(i["ngFileDragOverClass"]||"dragover");var s=[],f=e.dataTransfer.items;if(f&&f.length>0&&f[0].webkitGetAsEntry){for(var l=0;l<f.length;l++){a(s,f[l].webkitGetAsEntry())}}else{var c=e.dataTransfer.files;if(c!=null){for(var l=0;l<c.length;l++){s.push(c.item(l))}}}(function h(r){t(function(){if(!u){o(n,{$files:s,$event:e})}else{h(10)}},r||0)})()},false)}}}])})()